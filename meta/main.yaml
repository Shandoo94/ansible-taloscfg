galaxy_info:
  author: Shandoo
  description: Orchestration for generating talos machine configs
  license: MIT
  role_name: taloscfg
  namespace: taloscfg
  min_ansible_version: "2.9"

argument_specs:
  main:
    short_description: Generate Talos machine configuration bundles and per-node specs.
    options:
      taloscfg_server_group:
        type: str
        required: false
        description: Inventory group name identifying Talos control plane nodes.
      taloscfg_worker_group:
        type: str
        required: false
        description: Inventory group name identifying Talos worker nodes.
      taloscfg_common_patches:
        type: list
        elements: str
        required: false
        description: Sequence of patch file paths applied to all Talos nodes.
      taloscfg_common_server_patches:
        type: list
        elements: str
        required: false
        description: Sequence of patch file paths applied only to control plane nodes.
      taloscfg_common_worker_patches:
        type: list
        elements: str
        required: false
        description: Sequence of patch file paths applied only to worker nodes.
      taloscfg_machine_patches:
        type: list
        elements: str
        required: false
        description: Sequence of patch file paths applied to the current inventory host.
      taloscfg_target_dir:
        type: path
        required: false
        description: Destination directory where generated Talos configuration bundles are staged.
      taloscfg_secrets_file:
        type: path
        required: true
        description: Path to the Ansible Vault-encrypted Talos secrets file.
      taloscfg_secrets_file_decrypted:
        type: path
        required: false
        description: Temporary path where decrypted Talos secrets are stored.
      taloscfg_cluster_name:
        type: str
        required: false
        description: Name of the Talos cluster used during configuration generation.
      taloscfg_api_endpoint_cidr:
        type: str
        required: false
        description: API endpoint address (with CIDR) used for Talos control plane access.
      taloscfg_api_endpoint_port:
        type: int
        required: false
        description: TCP port exposed by the Talos API endpoint.
      taloscfg_kubernetes_version:
        type: str
        required: false
        description: Kubernetes release version embedded into generated Talos cluster manifests.
      taloscfg_talos_version:
        type: str
        required: false
        description: Talos operating system release used when rendering machine configurations.
      taloscfg_api_use_vip:
        type: bool
        required: false
        description: Whether to expose the Talos API via a virtual IP managed by Talos.
      taloscfg_vip_interface_name:
        type: str
        required: false
        description: Network interface name hosting the Talos virtual IP if enabled.
      taloscfg_use_cilium_cni:
        type: bool
        required: false
        description: Enable rendering of Cilium CNI manifests alongside Talos configs.
      taloscfg_cilium_replace_kubeproxy:
        type: bool
        required: false
        description: Configure Cilium to run in kube-proxy replacement mode.
      taloscfg_cilium_version:
        type: str
        required: false
        description: Version of the Cilium Helm chart rendered for deployment.
      taloscfg_rawVolume_list:
        type: list
        elements: dict
        required: false
        description: List of raw volume configurations; each dict defines options (e.g., name, diskSelector, minSize, maxSize) and a count for generating multiple instances via template loops.
      taloscfg_talos_image_schematic:
        type: dict
        required: false
        description: Schematic configuration dict for customizing the Talos installer image via factory.talos.dev API.
      taloscfg_talos_image_type:
        type: str
        required: false
        description: Type of Talos installer image (e.g., 'metal', 'aws', 'gcp') used in the factory image URL.
